(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57f2f936"],{"0cb2":function(e,t,a){var s=a("7b0b"),o=Math.floor,r="".replace,n=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,i=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,a,c,d,u){var l=a+e.length,h=c.length,p=i;return void 0!==d&&(d=s(d),p=n),r.call(u,p,(function(s,r){var n;switch(r.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,a);case"'":return t.slice(l);case"<":n=d[r.slice(1,-1)];break;default:var i=+r;if(0===i)return s;if(i>h){var u=o(i/10);return 0===u?s:u<=h?void 0===c[u-1]?r.charAt(1):c[u-1]+r.charAt(1):s}n=c[i-1]}return void 0===n?"":n}))}},"159b":function(e,t,a){var s=a("da84"),o=a("fdbc"),r=a("785a"),n=a("17c2"),i=a("9112"),c=function(e){if(e&&e.forEach!==n)try{i(e,"forEach",n)}catch(t){e.forEach=n}};for(var d in o)o[d]&&c(s[d]&&s[d].prototype);c(r)},"17c2":function(e,t,a){"use strict";var s=a("b727").forEach,o=a("a640"),r=o("forEach");e.exports=r?[].forEach:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}},"2f94":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return n})),a.d(t,"d",(function(){return i})),a.d(t,"f",(function(){return c})),a.d(t,"g",(function(){return d})),a.d(t,"h",(function(){return u})),a.d(t,"c",(function(){return l})),a.d(t,"e",(function(){return h}));var s=a("b775"),o=s["b"];function r(e){return o({url:"/api/wx/consignAddr/addOrUpdate",method:"POST",data:e})}function n(e){return o({url:"/api/wx/consignAddr/delete",method:"POST",data:e})}function i(e){return o({url:"/api/wx/consignAddr/info",method:"GET",params:e})}function c(e){return o({url:"/api/wx/consignAddr/list",method:"GET",params:e})}function d(e){return o({url:"/api/wx/map/parseByLocation",method:"GET",params:e})}function u(e){return o({url:"/api/wx/map/searchLocation",method:"GET",params:e})}function l(e){return o({url:"/api/wx/map/districtList",method:"GET",params:e})}function h(e){return o({url:"/api/wx/map/isInDeliverArea",method:"GET",params:e})}},"3d4b":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAApCAMAAACMabAwAAAAYFBMVEUAAACFhYWDg4OFhYWGhoaFhYWHh4eFhYWFhYWFhYWFhYWGhoaFhYWFhYWFhYWFhYWGhoaFhYWFhYWFhYWEhISHh4eFhYWFhYWFhYWGhoaEhISFhYWFhYWEhISFhYWFhYW9FeYWAAAAH3RSTlMA9hLLYuMH1Zkj3KttUTfrfii/hUAajFmzpKC3dy1HVbq6wgAAAaRJREFUOMt1k9t6gkAMhDe7LCignCzWqv3f/y0rhCzKR+cqkUkyE7PuDZehj4LEfri4Hfi2YUXT+i2hFl4oqrEdq2IKpf5s0E+fa29pPZH6tzbHEprrR821gfJo2VeEu9/qukP80jgP8LOj/QYhn6MBvt0evmGYRQjR7zJ8RCYpP3Cy37q26qu2s/Q0j/dCsJoKRWU9A+JdBtniOQJlKIGoPvXjDbxaKuD+fAXPOxRqwk9jCgrlPxbPKu2hUUFwQqVJSZMvjLyh1KhCHBx0sTA6wwi6zgMkxlkVJ4XnxJBloZ3OTpq6Za3iAlFnC31i9Ei+iAtTn6P9Uad1lzcTd5iyWscIctXbEKQzPaepe0jyCG3WBiBL0/ws9+ysVvHqZeqraclwt2MbIxBH3cVc/KuOWN+HP/r1fE3AEw32zvCamtU7hPNa6Zvp2rbIS7VgGwr5ljHCYc0qy1b88nHgvkhLMuPN6tBWrtbd+soGS5IUOb8Z3Xll2TtlgNK7LdqVUkOzsa+FRqkt2KWclGA2dgZRP5T3DzKB1GEfFzHCv+iK8uk+8AdilCdjtHlkBgAAAABJRU5ErkJggg=="},"3e0f":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var s=a("b775"),o=s["b"];function r(e){return o({url:"/api/wx/order/wxUnifiedPay",method:"POST",data:e})}},"3e1f":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-div"},[a("van-nav-bar",{attrs:{title:"下单","left-text":"返回","left-arrow":""},on:{"click-left":e.onClickLeft}}),a("Loading",{attrs:{loading:e.loadingPage}}),a("div",{staticClass:"main-center"},[a("div",{staticClass:"main-card"},["1"==e.radio?a("div",{staticClass:"top-time"},[e._v(" 自提时间 "),a("span",{staticClass:"con",on:{click:e.handleTime}},[e._v(" "+e._s(e.reserveTime)+" "),a("van-icon",{attrs:{name:"arrow"}})],1)]):a("div",{staticClass:"top-time"},[e._v(" 配送时间 "),a("span",{staticClass:"con",on:{click:e.handleTime}},[e._v(" "+e._s(e.sendTime)+" "),a("van-icon",{attrs:{name:"arrow"}})],1)]),a("div",{staticClass:"distribution-type"},[a("div",{class:"1"==e.radio?"bgc":"",on:{click:function(t){return e.handleType("1")}}},[e._v(" 自提 ")]),a("div",{class:"2"==e.radio?"bgc":"",on:{click:function(t){return e.handleType("2")}}},[e._v(" 配送 ")])])]),"1"==e.radio?a("div",{staticClass:"main-card shop-info"},[a("div",{staticClass:"shop-info-detail"},[a("div",{staticClass:"shop-name"},[e._v(e._s(e.orderList.storeName))]),a("div",{staticClass:"shop-address"},[e._v(e._s(e.orderList.storeAddress))])])]):e._e(),"2"==e.radio?a("div",{staticClass:"main-card address-info",on:{click:e.handleAddress}},[a("div",{staticClass:"userinfo_address"},[a("div",{staticClass:"address1"},[e.addressInfo.id&&e.addressInfo.isInDeliverArea?a("div",{staticClass:"hasaddress"},[a("div",{staticClass:"caddress-tel"},[e._v(" "+e._s(e.addressInfo.telephone)+" ")]),a("div",{staticClass:"caddress-addr"},[a("span",[e._v(e._s(e.addressInfo.detailAddress)+"-"+e._s(e.addressInfo.placeName)+e._s(e.addressInfo.houseNumber))])])]):a("div",{staticClass:"noaddress"},[a("span",{staticClass:"add"},[a("van-icon",{staticStyle:{"font-size":"22px","padding-right":"3px"},attrs:{name:"add-o",color:"#666!important"}}),a("span",[e._v("立即填写地址")])],1)])])]),a("van-icon",{attrs:{name:"arrow",size:"20",color:"#000"}})],1):e._e(),a("div",{staticClass:"main-card order-main"},[e._l(e.orderList.foodItemList,(function(t,s){return[a("div",{key:s,staticClass:"order-item"},[a("img",{staticClass:"goods-img",attrs:{src:t.foodImg}}),a("div",{staticClass:"goods-info"},[a("div",{staticClass:"goods-name"},[e._v(e._s(t.foodName))]),a("div",{staticClass:"goods-specifications"},[a("span",{staticClass:"specifications"},[e._v(e._s(e._f("getSizeJson")(t.sizeJson)))]),a("span",{staticClass:"num"},[e._v("x"+e._s(t.number))]),a("div",{staticClass:"price"})])]),a("div",{staticClass:"goods-price"},[a("div",{staticStyle:{"font-size":"0.29rem","text-align":"right"}},[e._v(" ￥ "+e._s(t.singleFoodPrice)+" ")])])])]})),e.orderList.isPickBySelf?e._e():a("div",{staticClass:"order_send"},[a("span",{staticClass:"left"},[e._v("配送费")]),a("span",{staticClass:"right"},[e._v("¥ "+e._s(e.orderList.deliveryFee))])]),a("div",{staticClass:"order_send"},[a("span",{staticClass:"left"},[e._v("包装费")]),a("span",{staticClass:"right"},[e._v("¥ "+e._s(e.orderList.packageFee))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMember,expression:"showMember"}]},[Array.isArray(e.orderList.canUseCouponList)||e.orderList.memberCoupon?a("div",{staticClass:"coupon-item"},[a("div",{staticClass:"icon"},[e._v("券")]),a("div",{staticClass:"title"},[e._v("优惠券")]),a("div",{staticClass:"coupon-detail"},[a("CouponComponents",{attrs:{canUseCouponList:e.orderList.canUseCouponList,disabledCouponList:e.disabledCouponList,memberCoupon:e.orderList.memberCoupon||{},couponName:e.couponName},on:{chosenCoupon:e.chosenCoupon}}),e.orderList.memberCoupon?3==e.orderList.memberCoupon.discountType?[e._v(" "+e._s("全场"+e.orderList.memberCoupon.unifiedPrice+"元任选")+" ")]:2==e.orderList.memberCoupon.discountType?[e._v(" "+e._s(e.orderList.memberCoupon.discountProportionShow+"折")+" ")]:[e._v(" -￥"+e._s(""+e.orderList.memberCoupon.discountPrice))]:[e._v("未使用或无可用优惠券")]],2)]):e._e()]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMember,expression:"showMember"}]},[Array.isArray(e.orderList.canUseVoucherList)||e.orderList.memberVoucher?a("div",{staticClass:"coupon-item"},[a("div",{staticClass:"icon"},[e._v("券")]),a("div",{staticClass:"title"},[e._v("抵用券")]),a("div",{staticClass:"coupon-detail"},[a("CouponComponents",{attrs:{canUseCouponList:e.orderList.canUseVoucherList,disabledCouponList:e.orderList.disabledVoucherList||[],closeButtonText:"不使用抵用券",memberCoupon:e.orderList.memberVoucher||{},couponName:e.couponName},on:{chosenCoupon:e.chosenVoucher}}),e.orderList.memberVoucher?3==e.orderList.memberVoucher.discountType?[e._v(" "+e._s("全场"+e.orderList.memberVoucher.unifiedPrice+"元任选")+" ")]:2==e.orderList.memberVoucher.discountType?[e._v(" "+e._s(e.orderList.memberVoucher.discountProportionShow+"折")+" ")]:[e._v(" -￥"+e._s(""+e.orderList.memberVoucher.discountPrice))]:[e._v("未使用或无可用抵用券")]],2)]):e._e()]),a("div",{staticClass:"divide"}),a("div",{staticClass:"total-detail"},[2==e.payStyle?a("div",{staticClass:"discount"},[a("div",{staticClass:"title"},[e._v("会员优惠金额")]),a("div",{staticClass:"price"},[e._v("￥"+e._s(e.orderList.memberDiscountPrice))])]):e._e()])],2),e.isMember?a("div",{staticClass:"main-card pay-style",on:{click:e.selectPayStyle}},[a("div",{staticClass:"title"},[e._v("支付方式")]),a("div",{staticClass:"pay"},["1"==e.payStyle?a("div",[a("img",{staticClass:"payicon",attrs:{src:e.wxPay,alt:""}}),a("span",[e._v("微信支付")]),a("van-icon",{attrs:{name:"arrow"}})],1):a("div",[a("img",{staticClass:"payicon",attrs:{src:e.bagPay,alt:""}}),a("span",[e._v("余额支付")]),a("van-icon",{attrs:{name:"arrow"}})],1)])]):e._e(),a("div",{staticClass:"main-card order-additional"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"2"==e.radio,expression:"radio == '2'"}],staticClass:"phone-detail"},[a("div",{staticClass:"title"},[e._v("预留手机")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.reserveTel,expression:"reserveTel"}],staticClass:"phone",domProps:{value:e.reserveTel},on:{input:function(t){t.target.composing||(e.reserveTel=t.target.value)}}})]),a("div",{staticClass:"divide"}),a("div",{staticClass:"remark-detail"},[a("div",{staticClass:"title"},[e._v("备注:")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.remark,expression:"remark"}],staticClass:"text",attrs:{rows:"3"},domProps:{value:e.remark},on:{input:function(t){t.target.composing||(e.remark=t.target.value)}}})])]),a("div",{staticClass:"main-bottom"},[a("div",{staticClass:"order-price"},[2==e.payStyle?a("div",{staticClass:"price"},[e._v(" ￥"+e._s(e.orderList.balancePay)+" ")]):a("div",{staticClass:"price"},[e._v("￥"+e._s(e.orderList.actualPrice))]),2==e.payStyle?a("div",{staticClass:"discount"},[e._v(" 共优惠￥"+e._s((e.orderList.memberDiscountPrice+e.orderList.discountedPrice+e.orderList.activeDiscountPrice).toFixed("2"))+" ")]):a("div",{staticClass:"discount"},[e._v(" 共优惠￥ "+e._s((e.orderList.activeDiscountPrice+e.orderList.discountedPrice).toFixed("2"))+" ")])]),a("div",{staticClass:"submit-btn",on:{click:e.handlePay}},[e._v("去支付")])]),a("van-popup",{attrs:{position:"bottom"},on:{"click-overlay":function(t){e.show=!1}},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[a("van-picker",{attrs:{"show-toolbar":"",title:"取餐时间",columns:e.columns},on:{cancel:e.onCancel,confirm:e.onConfirm,change:e.onChange}})],1),a("van-popup",{staticClass:"selectpay",model:{value:e.styleshow,callback:function(t){e.styleshow=t},expression:"styleshow"}},[a("div",{staticClass:"title"},[e._v("支付方式")]),a("van-radio-group",{staticClass:"gender-radio",model:{value:e.payStyle,callback:function(t){e.payStyle=t},expression:"payStyle"}},[e.balanceAmount<e.orderList.balancePay?a("div",{staticClass:"balance-zero"},[a("div",[a("img",{staticClass:"payicon",attrs:{src:e.bagPay,alt:""}}),e._v(" 余额支付（￥"+e._s(e.balanceAmount)+"） ")]),a("div",{staticClass:"right",on:{click:e.handlerecharge}},[e._v("立即充值")])]):a("van-radio",{staticClass:"female",attrs:{name:"2",shape:"square"},on:{click:function(t){return e.selectPay("2")}}},[a("img",{staticClass:"payicon",attrs:{src:e.bagPay,alt:""}}),e._v(" 余额支付（￥"+e._s(e.balanceAmount)+"） ")]),a("div",{staticClass:"line"}),a("van-radio",{attrs:{name:"1",shape:"square"},on:{click:function(t){return e.selectPay("1")}}},[a("img",{staticClass:"payicon",attrs:{src:e.wxPay,alt:""}}),e._v(" 微信支付 ")])],1)],1)],1)],1)},o=[],r=a("2909"),n=a("1da1"),i=(a("96cf"),a("a15b"),a("d81d"),a("159b"),a("ac1f"),a("5319"),a("d3b7"),a("ddb0"),a("99af"),a("4ec3")),c=a("3d4b"),d=a.n(c),u=a("cc71"),l=a.n(u),h=a("aab8"),p=a.n(h),m=a("3e0f"),f=a("18a0"),v=a.n(f),g=a("80c4"),b=a("fa7d"),C=a("2241"),y=a("d399"),A=a("2f94"),L=a("f99e"),w={data:function(){return{loadingPage:!0,locationHollow:d.a,dataList:{},remark:"",orderList:{},reserveTel:"",addressInfo:{},reserveTime:void 0,canUseCouponList:[],disabledCouponList:[],pickIndex:null,columns:[{values:[],defaultIndex:0},{values:[],defaultIndex:1}],radio:null,show:!1,sendTime:"",payStyle:"1",showpayTypes:!0,showMember:!0,isMember:!1,wxPay:p.a,bagPay:l.a,styleshow:!1,balanceAmount:0,selectCouponName:""}},components:{CouponComponents:L["a"]},filters:{getSizeJson:function(e){if(!e)return"默认";var t=JSON.parse(e).map((function(e){return e.tagValue.sizeName})).join(",");return t}},beforeRouteEnter:function(e,t,a){console.log("路由守卫===="),console.log(e),console.log(t.path,"from.path"),a((function(e){if(console.log(e),console.log(e.radio," vm.radio"),"/bind"===t.path){var a=localStorage.getItem("radio");e.radio=a}}))},created:function(){console.log(this.$route.path,"his.$route.path"),this.couponName=this.$route.query.couponName,0==this.$route.query.showMember&&(this.showMember=this.$route.query.showMember,console.log(this.$route.query.showMember,"会员卡优惠券0000"));var e=JSON.parse(localStorage.getItem("orderInfo"));this.reserveTel=JSON.parse(localStorage.getItem("reserveTel")),e&&(console.log(e,"9090"),this.radio=2,this.reserveTel=e.reserveTel,this.reserveTime=e.reserveTime,console.log(this.reserveTime,"自提时间"),this.sendTime=e.sendTime,this.remark=e.remark);JSON.parse(localStorage.getItem("sendType"));this.radio="1",this.$set(this.dataList,"isPickBySelf",!0),this.storeNo=this.$route.query.storeNo;var t=JSON.parse(decodeURIComponent(this.$route.query.foodList||"[]"));Array.isArray(t)&&t.length>0?this.localFoods=t:JSON.parse(localStorage.getItem("buy".concat(this.storeNo)))?this.localFoods=JSON.parse(localStorage.getItem("buy".concat(this.storeNo))):this.localFoods=JSON.parse(localStorage.getItem("cart".concat(this.storeNo)));var a=[];console.log(this.localFoods,"eeeee"),this.localFoods&&this.localFoods.forEach((function(e,t){var s={};s.foodId=e.foodId,s.number=e.num,e.sizeList&&(s.sizeList=e.sizeList,s.sizeJson=JSON.stringify(e.sizeList)),a.push(s)})),this.dataList.foodItemList=a,this.dataList.storeNo=this.storeNo,this.dataList.eatTime="3",this.dataList.useVoucher=!0,this.$set(this.dataList,"useCoupon",!0);var s=this.$route.query.consignAddrId;s&&s>=0&&(this.$set(this.dataList,"consignAddrId",s),this.info(s),this.radio="2",this.dataList.isPickBySelf=!1,this.isHasAddr=!0),this.checkout();var o=localStorage.getItem("type");this.radio=o,console.log(this.dataList,"09099"),"1"===this.radio?(this.dataList.isPickBySelf=!0,this.addressInfo.length>0&&!this.addressInfo.id&&(this.addressInfo=this.orderList.consignAddress)):this.dataList.isPickBySelf=!1},methods:{loadingTime:function(e){var t=this;this.loadingPage=!0,setTimeout((function(){t.loadingPage=!1,t.$router.replace(e)}),2e3)},getRecentSchedule:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("只给你-"),a=JSON.parse(localStorage.getItem("storeNo")),t.next=4,Object(i["o"])({storeNo:a});case 4:for(s=t.sent,""!==e.reserveTime&&e.reserveTime||(e.reserveTime=s.data.data.mapList[0].schedule[0],console.log(e.reserveTime,"this.reserveTime")),""===e.sendTime&&(e.sendTime=s.data.data.mapList[0].schedule[0],e.dataList.orderDate=s.data.data.mapList[0].date),e.columns[0].values=s.data.data.composes,null==e.pickIndex&&(e.dataList.orderDate=s.data.data.mapList[0].date,e.columns[1].values=Object(r["a"])(s.data.data.mapList[0].schedule)),o=0;o<s.data.data.composes.length;o++)e.pickIndex==s.data.data.composes[o]&&(e.columns[1].values=Object(r["a"])(s.data.data.mapList[o].schedule));e.loading=!1,setTimeout((function(){e.loadingPage=!1}),1e3);case 12:case"end":return t.stop()}}),t)})))()},chosenCoupon:function(e){this.coupons=e,console.log("00000000",this.coupons),e.id?this.$set(this.dataList,"useCoupon",!0):this.$set(this.dataList,"useCoupon",!1),1==this.orderList.foodItemList.reduce((function(e,t){return e+t.number}),0)&&this.$delete(this.dataList,"memberVoucherId"),this.$set(this.dataList,"memberCouponId",e.id),this.checkout()},chosenVoucher:function(e){e.id?this.$set(this.dataList,"useVoucher",!0):this.$set(this.dataList,"useVoucher",!1),1==this.orderList.foodItemList.reduce((function(e,t){return e+t.number}),0)&&this.$delete(this.dataList,"memberCouponId"),this.$set(this.dataList,"memberVoucherId",e.id),this.checkout()},handlePay:function(){var e=this;console.log(this.dataList),console.log(this.remark,"this.remark"),this.$set(this.dataList,"remark",this.remark),console.log("596去支付====222"),sessionStorage.removeItem("couponDetail"),2==this.payStyle?(console.log("payStyl执行了"),C["a"].confirm({message:"是否使用余额支付",title:"温馨提示"}).then((function(){console.log("tankuagn",e.balanceAmount,e.orderList.balancePay),e.balanceAmount<e.orderList.balancePay?C["a"].confirm({message:"钱包余额不足，是否充值？",title:"温馨提示",confirmButtonText:"是",cancelButtonText:"否"}).then((function(){e.handlerecharge()})):e.orderSubmit()})).catch((function(){}))):this.orderSubmit()},onClickLeft:function(){localStorage.removeItem("orderInfo"),this.$router.push("foods1/"+this.storeNo)},checkout:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(i["R"])(e.dataList);case 3:if(a=t.sent,console.log("checkout数据",JSON.stringify(e.dataList)),a&&a.data){t.next=7;break}throw new Error(a);case 7:a.data.data.memberTelephone&&(e.reserveTel=a.data.data.memberTelephone),e.orderList=a.data.data,e.showpayTypes=a.data.data.isBalancePay,e.isMember=a.data.data.isMember,console.log("是否为会员isMember",e.isMember),console.log(" this.orderList",e.orderList),e.balanceAmount=a.data.data.balanceAmount,e.canUseCouponList=a.data.data.canUseCouponList,e.disabledCouponList=a.data.data.disabledCoupons||[],e.specification=a.data.data.foodItemList.map((function(e){var t="";if(e.sizeList){var a=e.sizeList;return a.forEach((function(e){t=t+e.tagValue.sizeName+" "})),t}return t})),e.orderList.useCoupon&&e.orderList.memberCoupon&&e.$set(e.dataList,"memberCouponId",e.orderList.memberCoupon.id),e.orderList.useVoucher&&e.orderList.memberVoucher&&e.$set(e.dataList,"memberVoucherId",e.orderList.memberVoucher.id),!e.addressInfo.id&&e.orderList.consignAddress&&e.info(e.orderList.consignAddress.id),e.isMember&&(e.payStyle="2"),e.isMember||(e.payStyle="1"),e.getRecentSchedule(),t.next=32;break;case 25:t.prev=25,t.t0=t["catch"](0),e.$senty.captureException(t.t0),s=e,s.loadingPage=!1,console.log("checkouterror",t.t0),"优惠券不可用"===t.t0.data.msg&&s.$router.push({path:"/foods1/"+s.storeNo,query:{couponName:s.selectCouponName}});case 32:case"end":return t.stop()}}),t,null,[[0,25]])})))()},orderSubmit:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("提交订单======",e.reserveTel,e.orderList),"2"==e.radio&&"0000"==e.reserveTel&&C["a"].confirm({message:"配送方式需要绑定手机号,",title:"绑定手机号"}).then((function(){e.$router.push("/bind?psong=true")})).catch((function(){})),!e.isClick){t.next=6;break}return Object(y["a"])("正在提交订单中，请不要多次提交，谢谢!"),setTimeout((function(){e.isClick=!1}),3e3),t.abrupt("return",!1);case 6:a=JSON.parse(localStorage.getItem("orderNo")),setTimeout(Object(n["a"])(regeneratorRuntime.mark((function t(){var s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=4;break}e.orderNo=a,t.next=46;break;case 4:if(!0!==e.dataList.isPickBySelf||!e.reserveTel){t.next=15;break}if(/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(e.reserveTel)||"2"!=e.radio){t.next=10;break}return C["a"].alert({message:"预留手机号格式不正确!"}).then((function(){})),t.abrupt("return",!1);case 10:e.dataList.reserveTelephone=e.reserveTel,e.dataList.orderTime=e.reserveTime,console.log(e.reserveTime,"自提时间3");case 13:t.next=35;break;case 15:if(!1!==e.dataList.isPickBySelf||!e.addressInfo||!e.addressInfo.isInDeliverArea){t.next=21;break}e.isHasAddr=!0,e.$set(e.dataList,"consignAddrId",e.addressInfo.id),e.dataList.orderTime=e.sendTime,t.next=35;break;case 21:if(!1!==e.dataList.isPickBySelf||e.addressInfo){t.next=27;break}return e.isHasAddr=!1,C["a"].alert({message:"请填写收货地址!"}).then((function(){})),t.abrupt("return",!1);case 27:if(!1!==e.dataList.isPickBySelf||!e.addressInfo||e.addressInfo.isInDeliverArea){t.next=33;break}return e.isHasAddr=!1,C["a"].alert({message:"请填写收货地址!"}).then((function(){})),t.abrupt("return",!1);case 33:return C["a"].alert({message:"请填写预留手机号!"}).then((function(){})),t.abrupt("return",!1);case 35:return e.isClick=!0,s=JSON.parse(localStorage.getItem("inviterNo"))||null,s&&(e.dataList.referrerMemberNo=s),console.log(e.dataList,"768this.dataList"),"0000"!==e.reserveTel&&"2"==e.radio&&(e.dataList.reserveTelephone=e.reserveTel),console.log(e.dataList,"this.orderList.phone"),t.next=43,Object(i["A"])(e.dataList);case 43:o=t.sent,200===o.status&&(localStorage.removeItem("cart".concat(e.storeNo)),localStorage.removeItem("buy".concat(e.storeNo)),e.orderNo=o.data.data,localStorage.setItem("orderNo",JSON.stringify(e.orderNo)),localStorage.setItem("reserveTel",JSON.stringify(e.reserveTel))),setTimeout((function(){e.isClick=!1}),3e3);case 46:if("1"!=e.payStyle){t.next=50;break}Object(b["c"])("orderNo=".concat(e.orderNo)),t.next=55;break;case 50:return t.next=52,Object(g["a"])({orderNo:e.orderNo});case 52:o=t.sent,console.log("跳转到payresult"),200==o.data.code?e.$router.push({path:"/payresult",query:{isOk:1,orderNo:e.orderNo,type:1}}):(e.ispay=0,e.$router.push({path:"/payresult",query:{isOk:0,orderNo:e.orderNo,type:1}}));case 55:case"end":return t.stop()}}),t)}))),0);case 8:case"end":return t.stop()}}),t)})))()},wxUnifiedPay:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.prev=1,t.next=4,Object(m["a"])({orderNo:a.orderNo});case 4:if(s=t.sent,a.config=s.data.data,"undefined"!==typeof WeixinJSBridge){t.next=10;break}document.addEventListener?document.addEventListener("WeixinJSBridgeReady",a.onBridgeReady(),!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",a.onBridgeReady()),document.attachEvent("onWeixinJSBridgeReady",a.onBridgeReady())),t.next=12;break;case 10:return a.onBridgeReady(),t.abrupt("return",!1);case 12:a.time=setInterval((function(){"undefined"!==typeof WeixinJSBridge&&0===a.ispay&&(a.ispay=1,a.onBridgeReady(),clearInterval(a.time))}),300),t.next=17;break;case 15:t.prev=15,t.t0=t["catch"](1);case 17:case"end":return t.stop()}}),t,null,[[1,15]])})))()},onBridgeReady:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e,setTimeout((function(){WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:a.config.appId,timeStamp:a.config.timeStamp,nonceStr:a.config.nonceStr,package:a.config.packageValue,signType:a.config.signType,paySign:a.config.paySign},(function(e){localStorage.removeItem("orderInfo"),localStorage.removeItem("orderNo"),localStorage.removeItem("sendType"),"get_brand_wcpay_request:ok"===e.err_msg?a.$router.push({path:"/payresult",query:{isOk:1,orderNo:a.orderNo,type:1}}):(a.ispay=0,a.$router.push({path:"/payresult",query:{isOk:0,orderNo:a.orderNo,type:1}}))}))}),100);case 2:case"end":return t.stop()}}),t)})))()},handleTime:function(){this.show=!0},onCancel:function(){this.show=!1},onConfirm:function(e,t){this.show=!1,"1"===this.radio?this.reserveTime=e[1]:this.sendTime=e[1]},onChange:function(e,t){this.pickIndex=t[0],console.log(this.pickIndex),this.getRecentSchedule()},ongetColumnIndex:function(e){console.log(e)},info:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(A["d"])({id:e,storeNo:t.storeNo});case 2:s=a.sent,t.addressInfo=s.data.data;case 4:case"end":return a.stop()}}),a)})))()},handleType:function(e){console.log(e),this.radio=e,localStorage.setItem("radio",this.radio),"1"===this.radio?(this.dataList.isPickBySelf=!0,this.addressInfo.length>0&&!this.addressInfo.id&&(this.addressInfo=this.orderList.consignAddress)):this.dataList.isPickBySelf=!1,this.checkout()},handleAddress:function(){console.log(this.reserveTime,"自提时间44");var e={};e.radio=this.radio,e.reserveTel=this.reserveTel,e.reserveTime=this.reserveTime,e.sendTime=this.sendTime,e.remark=this.remark,localStorage.setItem("orderInfo",JSON.stringify(e)),this.addressInfo?this.loadingTime({path:"/address",query:{storeNo:this.storeNo,chosenAddressId:this.addressInfo.id}}):this.loadingTime({path:"/address",query:{storeNo:this.storeNo,chosenAddressId:-1}})},selectPayStyle:function(){this.styleshow=!0},selectPay:function(e){console.log(e),this.styleshow=!1,this.payStyle=e},handlerecharge:function(){console.log("充值"),this.$isMiniprogram?v.a.miniProgram.navigateTo({url:"/pages/balanceRecharge/balanceRecharge?callBackPath=".concat(encodeURIComponent(window.location.href),"&token=").concat(JSON.parse(localStorage.getItem("token")))}):this.$router.push("/consumption/recharge")}}},T=w,k=(a("b2e2"),a("2877")),S=Object(k["a"])(T,s,o,!1,null,"1f70ea36",null);t["default"]=S.exports},5319:function(e,t,a){"use strict";var s=a("d784"),o=a("d039"),r=a("825a"),n=a("1626"),i=a("5926"),c=a("50c4"),d=a("577e"),u=a("1d80"),l=a("8aa5"),h=a("dc4a"),p=a("0cb2"),m=a("14c3"),f=a("b622"),v=f("replace"),g=Math.max,b=Math.min,C=function(e){return void 0===e?e:String(e)},y=function(){return"$0"==="a".replace(/./,"$0")}(),A=function(){return!!/./[v]&&""===/./[v]("a","$0")}(),L=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));s("replace",(function(e,t,a){var s=A?"$":"$0";return[function(e,a){var s=u(this),o=void 0==e?void 0:h(e,v);return o?o.call(e,s,a):t.call(d(s),e,a)},function(e,o){var u=r(this),h=d(e);if("string"===typeof o&&-1===o.indexOf(s)&&-1===o.indexOf("$<")){var f=a(t,u,h,o);if(f.done)return f.value}var v=n(o);v||(o=d(o));var y=u.global;if(y){var A=u.unicode;u.lastIndex=0}var L=[];while(1){var w=m(u,h);if(null===w)break;if(L.push(w),!y)break;var T=d(w[0]);""===T&&(u.lastIndex=l(h,c(u.lastIndex),A))}for(var k="",S=0,x=0;x<L.length;x++){w=L[x];for(var I=d(w[0]),N=g(b(i(w.index),h.length),0),P=[],_=1;_<w.length;_++)P.push(C(w[_]));var R=w.groups;if(v){var O=[I].concat(P,N,h);void 0!==R&&O.push(R);var E=d(o.apply(void 0,O))}else E=p(I,h,N,P,R,o);N>=S&&(k+=h.slice(S,N)+E,S=N+I.length)}return k+h.slice(S)}]}),!L||!y||A)},8024:function(e,t,a){},"80c4":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return c}));var s=a("b775"),o=s["b"];function r(e){return o({url:"/api/wx/balance/balanceRecharge",method:"POST",data:e})}function n(e){return o({url:"/api/wx/balance/balanceRechargeListOrBalance",method:"GET",params:e})}function i(e){return o({url:"/api/wx/balance/balancePay",method:"POST",data:e})}function c(e){return o({url:"/api/wx/balance/balanceStreamList",method:"GET",params:e})}},"83f0":function(e,t,a){},a15b:function(e,t,a){"use strict";var s=a("23e7"),o=a("44ad"),r=a("fc6a"),n=a("a640"),i=[].join,c=o!=Object,d=n("join",",");s({target:"Array",proto:!0,forced:c||!d},{join:function(e){return i.call(r(this),void 0===e?",":e)}})},a640:function(e,t,a){"use strict";var s=a("d039");e.exports=function(e,t){var a=[][e];return!!a&&s((function(){a.call(null,t||function(){throw 1},1)}))}},aab8:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAABO5JREFUWEftl21sU2UUx895bm9fbrt1GwyQZXPLhMQtRhAIojC6tmNfkA9oYqJRYlAkGKMIiYIJGMgMyocpEudL/LAEcEAIcYkMR7vW6WQmzqGGBAQHghPIRruuL2vLvc8xt2OljN52r4kfeD41fc75n989zznnPheJSID/ycL7MBonMa7MFHmL5g0pgwviXFnGkR4FoDkAYAEABQEDiOw6V5QzBiZ2SkLu2d7q3ovjqYCsMLW/1xp/7vtptczlLRxpSVZxRACihBkCdAmobygXyo9127qD2XwzwuR6ctfJSnw3AMzNJpR5n26KqN8ZcAQ/y2SXFqbih4pZf8d6jhLAk5ODGO1Np2ey2S9csV+5nE73HphCT96CsBJtAYDCqQVJqkWNINX4nL7To/XvginwFDweVSI/ThPEXbIGJq7024MdqX8mYUq7Smf19d/oIYGM0wKjAIA6XhHbdCCcWDRnyeeeSs9QWhjJY2hHGZ8gnAYUAmBG1iQoYmPAFjilRqj2Lsw5Q3+t9VcPNo5ETGTG4rbUEFdaCIdbcgrXDQR2tFCf9+nlqn//HNHNc5nXx1HeA4T5emZ0DNgHvk+MggTMKamNI6+aKgh1vjBB+KZSeuTjzqWd4RHdGW5rTZTiOwhoWTIbwJrDzsjaBMzC9ocKz8Wu/gMA+jQw1xmwrznwVwDBAlkShwAn9ahr8jtCB1K15rQXVIRisc0clZfSxKAiXXHJBduFa5jvljZGOW+A9JGuRZzR4mJvcZlP7j9AQEvTiMV1wA4zQd84UD3gTd1f3rFc+i3W/ZbClfcyZV0AcVPQGfwCpVZjAzDaeHuC3+Mjgm5zwBn6RN2wuKS9HPjm20a9gNA0W3hg/yXbpaujHa1tludkLtdxgOJsPSEA1gWdQzvR7DId4MSf1yJHgN76/H1lGxZt4KpNvit/BTFlXpXVdrB5UXNstN8Mj9UZU2LvcADbWGpQPXmB2Aehmsi7KHUYv4QAvUyitisjtjVUE/kok3hp+9z5fTHfLkJ4ZiwQd9oZgPTsw8jKyHbMceVslylel0kAAXvDzqEH09ms6Vpj8Ppad8sIbwIAGw/IcDurM0jYFVwR3oUz3dbHwhDtAnVCahyumko9M7wYsAcOpQbLd+e8FqdbWzhASba60IREACMZVvucgZOJOWP6ztDDRFZCXKN3EwcL5yP2aKUqOsNrrYkp8W2caApmE/ZEnEPzk0NPajHVgZHeTmRHcxEwYEeA2BBHZZ3KN+FspMQQUdgRcITfT8Is7lpsOev7ow8RM5TxeKshuz0yHHyYlZT/YjvvT8KoP6wu66ZbEN03Nc+bHURNqyCLzwZrg8fudFbKd5PZLR0n4k+NQWpyJqi2nfBVyBF+NVXonpue2WU6QUCrJhctszdDoTHkCK8fbZX2DpxzyrRfQdo4HUAM2N6QM7Itnbbm14G5Taonzl+fQqBzBjRt8jv87VqamjC5bblbZR7fkywu0HivZ5pmwzeBi6Jg2B2oDhzM9mCaMJLb1ApE9oSAOlAIDyHgAAFX66k8w5hRX6iXBYBvRUF/2Fc92JkNIm03jfxZ5i0rviFfuzTMgS4Tmrf3O/p/Td0PKr5CGTCPI7cInJADhVGnu1nAC/p67D3qZW3cK21m8lw5T8fhVr2ei28MrAoeH7fqBB2yfmtPUHdCbvdhtNL2H+qLHEKFf64PAAAAAElFTkSuQmCC"},b2e2:function(e,t,a){"use strict";a("8024")},b64b:function(e,t,a){var s=a("23e7"),o=a("7b0b"),r=a("df75"),n=a("d039"),i=n((function(){r(1)}));s({target:"Object",stat:!0,forced:i},{keys:function(e){return r(o(e))}})},cc71:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAMAAAApB0NrAAAAVFBMVEX9/v4eTEQeTUUeTUUeTUUeTUUgTkYdTEQdTUQhUEgfTEQfTkchT0gjU0ckUkoyXlYdTEQdTEQeTUUfTUQdTUUeTUUhT0cuV1EyXFU/amQdTEQdTERj4iAvAAAAG3RSTlMD8pjByqCA+s9TnXptRjYe49e1r66nXiwkEuiEDYKgAAAAm0lEQVQ4y83S2Q6DIBBA0aGArILWvfP//9kQGk0aAW1s4nm+gWGBX6leDgpyaomBgST3xI8lUUw9rvj+LmGNjdsblb4k3TAL5yyWB/rxjWsL0dxgGotNhzmxIZhBYiMONOS/TXnmlkU02YgRVqlmhLry+UaAR2xKzYSIhb0cmE4VmnYuz4xCV5E5cYd3edOL/9hw4OxekjQO13kDRtxEOxt8nQ4AAAAASUVORK5CYII="},d4b0:function(e,t,a){"use strict";a("83f0")},d81d:function(e,t,a){"use strict";var s=a("23e7"),o=a("b727").map,r=a("1dde"),n=r("map");s({target:"Array",proto:!0,forced:!n},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},f99e:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"coupon"},[a("van-coupon-cell",{staticClass:"coupon_cell",attrs:{coupons:e.coupons,"chosen-coupon":e.chosenCoupon,currency:" "},on:{click:function(t){e.showList=!0}}}),a("van-popup",{staticStyle:{height:"90%","padding-top":"4px"},attrs:{round:"",position:"bottom"},model:{value:e.showList,callback:function(t){e.showList=t},expression:"showList"}},[a("van-coupon-list",{attrs:{coupons:e.coupons,"chosen-coupon":e.chosenCoupon,"disabled-coupons":e.disabledCoupons,"show-exchange-bar":e.showexchangebar,editable:e.editable,"close-button-text":e.closeButtonText},on:{change:e.onChange}})],1)],1)},o=[],r=(a("b64b"),a("159b"),a("d81d"),a("2b0e")),n=a("ac3c"),i=a("453b");r["a"].use(n["a"]),r["a"].use(i["a"]);var c={props:{disabledCouponList:{type:Array,default:function(){return[]}},canUseCouponList:{type:Array},memberCoupon:{type:Object},couponName:{type:String},closeButtonText:{type:String,default:"不使用优惠券"}},data:function(){return{editable:!1,showexchangebar:!1,showList:!1,chosenCoupon:-1,coupons:[],disabledCoupons:[],couponList:[]}},watch:{memberCoupon:function(e,t){0==Object.keys(e).length?this.chosenCoupon=-1:-1==this.chosenCoupon&&(this.chosenCoupon=0)}},methods:{onChange:function(e){console.log(this.chosenCoupon,e,"this.chosenCoupon"),console.log("this.coupons",this.coupons,this.couponName),this.showList=!1,this.chosenCoupon=e,this.$emit("chosenCoupon",this.coupons[e]?this.coupons[e]:{})}},mounted:function(){var e=this;setTimeout((function(){e.couponList=e.canUseCouponList,e.couponList&&e.couponList.length>0&&e.couponList.forEach((function(t,a){var s={};if(s.id=t.id,s.condition=t.couponName,s.reason="",s.value=100*t.discountPrice,s.name=t.storeName,s.startAt=Date.parse(new Date(t.validStartDate))/1e3,s.endAt=Date.parse(new Date(t.validEndDate))/1e3,s.valueDesc=t.discountPrice,s.unitDesc="元",s.description=t.rule,3==t.discountType&&(s.condition="全场".concat(t.unifiedPrice,"元任选"),s.valueDesc="",s.unitDesc=""),2==t.discountType&&(s.valueDesc=t.discountProportionShow,s.unitDesc="折"),0==t.status&&(e.coupons.push(s),e.memberCoupon&&e.memberCoupon.id===t.id&&(e.chosenCoupon=a,console.log(e.memberCoupon,e.memberCoupon.id,e.chosenCoupon)),e.couponName))for(a=0;a<e.coupons.length;a++)console.log("00"),e.coupons[a].condition==e.couponName&&(console.log("11"),e.chosenCoupon=a,e.$emit("chosenCoupon",e.coupons[a]?e.coupons[a]:{}))})),e.disabledCoupons=e.disabledCouponList.map((function(e){var t={id:e.id,condition:e.couponName,reason:e.reason,value:100*e.discountPrice,name:e.storeName,valueDesc:e.discountPrice,unitDesc:"元",startAt:Date.parse(new Date(e.validStartDate))/1e3,endAt:Date.parse(new Date(e.validEndDate))/1e3};return 3==e.discountType&&(t.condition="全场".concat(e.unifiedPrice,"元任选")),2==e.discountType&&(t.valueDesc=e.discountProportionShow,t.unitDesc="折"),t})),console.log(e.disabledCoupons,321312)}),1e3)}},d=c,u=(a("d4b0"),a("2877")),l=Object(u["a"])(d,s,o,!1,null,"5a1dd9c6",null);t["a"]=l.exports},fa7d:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"c",(function(){return u}));var s=a("1da1"),o=(a("96cf"),a("99af"),a("a078")),r=a("4ec3"),n=a("18a0"),i=a.n(n),c=function(e){var t=JSON.parse(localStorage.getItem("token"));return!!t||(e&&Object(o["a"])({redirectPath:"/blank"}),!1)},d=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(r["r"])();case 2:if(a=e.sent,a&&a.data&&a.data.data.memberTelephone){e.next=7;break}return t.$toast("请先绑定手机号"),i.a.miniProgram.reLaunch({url:"/pages/bindPhone/bindPhone?nextPath=".concat(encodeURIComponent("https://m.yiqiwen.cn/dist/tlzb?phone="),"&token=").concat(JSON.parse(localStorage.getItem("token")))}),e.abrupt("return");case 7:i.a.miniProgram.reLaunch({url:"/pages/thirdParty/thirdParty?webUrl=".concat(encodeURIComponent("https://m.yiqiwen.cn/dist/tlzb?phone=".concat(a.data.data.memberTelephone)),"&token=").concat(JSON.parse(localStorage.getItem("token")))});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(e){i.a.miniProgram.navigateTo({url:"/pages/payment/payment?token=".concat(JSON.parse(localStorage.getItem("token")),"&").concat(e)})}}}]);