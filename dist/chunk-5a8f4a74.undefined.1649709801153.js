(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a8f4a74"],{"30dc":function(t,e,a){"use strict";a("98e6")},6389:function(t,e,a){"use strict";a("9b25")},"69b4":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"foods"},[a("van-nav-bar",{staticClass:"title",attrs:{"left-text":"返回","left-arrow":"",title:"团餐菜单",fixed:""},on:{"click-left":t.onClickLeft}}),a("Loading",{attrs:{loading:t.loadingPage}}),a("div",{staticClass:"sort"},[a("div",{staticClass:"shopdesk"},[a("div",{staticClass:"name"},[a("div",{staticClass:"shop_left",on:{click:function(e){return t.toShopList()}}},[a("img",{attrs:{src:t.shop.storeLogo?""+t.$imgUrl+t.shop.storeLogo:t.logo}}),a("span",{staticClass:"shopdesk_name"},[t._v(t._s(t.shop.storeName))]),a("van-icon",{attrs:{name:"arrow",color:"#112e59"}})],1)]),a("div",{staticClass:"shopdesk_content"},[a("div",{staticClass:"shopdesk_distance"},[t._v("取餐地址")]),a("div",{staticClass:"shopdesk_adress"},[a("van-icon",{attrs:{name:"location-o"}}),t._v(" "+t._s(t.shop.storeAddress)+" ")],1)]),a("div",{staticClass:"shop_right"},[t._v("团餐")])]),a("van-tabs",{on:{click:t.handleClick},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[a("van-tab",{attrs:{title:"点餐"}},[t.loading?t._e():a("Food",{attrs:{foodData:t.foods,total:t.total,storeAdvertise:t.storeAdvertise,storeAdvertiseTwo:t.storeAdvertiseTwo},on:{handleAdd:t.handleAdd,handleReduce:t.handleReduce}}),t.showShop?t._e():a("div",{staticClass:"footer"},[a("div",{staticClass:"left"},[a("div",{class:t.allPrice>0?"cart_active":"cart",on:{click:t.handleCart}},[a("van-icon",{attrs:{name:"shopping-cart",color:"#000"}}),t.total>0?a("span",{staticClass:"total"},[t._v(t._s(t.total))]):t._e()],1),t.allPrice>0?a("span",{staticClass:"allPrice"},[t._v("￥"+t._s(t.allPrice))]):t._e()]),t.total>0?a("div",{staticClass:"right",on:{click:t.handleAccount}},[a("span",[t._v("提交订单")])]):t._e(),0==t.total?a("div",{staticClass:"right"},[a("span",{staticStyle:{background:"#ccc"}},[t._v("未选购商品")])]):t._e()])],1),a("van-tab",{attrs:{title:"商家"}},[a("div",{staticClass:"shop"},[a("div",{staticClass:"shop_Introduction"},[a("span",{staticClass:"left"},[t._v("简介:")]),a("span",{staticClass:"right"},[t._v(t._s(t.shop.storeNotice?t.shop.storeNotice:"暂无相关信息"))])]),a("div",{staticClass:"shop_Introduction"},[a("span",{staticClass:"left"},[t._v("商家电话:")]),a("span",{staticClass:"right_tel"},[t._v(t._s(t.shop.storeTelephone))]),a("a",{attrs:{href:"tel:"+t.shop.storeTelephone}},[a("van-icon",{attrs:{name:"phone-circle-o"}})],1)]),a("div",{staticClass:"shop_Introduction"},[a("span",{staticClass:"left"},[t._v("营业时间:")]),a("span",{staticClass:"right"},[t._v(t._s(t.shop.openTime)+" - "+t._s(t.shop.offTime))])]),a("div",{staticClass:"shop_Introduction"},[a("span",{staticClass:"left"},[t._v("商家地址:")]),a("span",{staticClass:"right"},[t._v(t._s(t.shop.storeAddress))])]),a("div",{staticClass:"proof"},[a("div",{staticClass:"proof_title"},[t._v("店内照片")]),t.shop.storeEnvironmentImg?a("div",{staticClass:"proof_content"},t._l(t.shopImg,(function(e,o){return a("img",{key:o,attrs:{src:""+t.$imgUrl+e},on:{click:function(e){return t.handleActivity(o)}}})})),0):t._e()])])]),a("van-tab",{attrs:{title:"评论"}},[a("div",{staticClass:"comment"},[a("Comment",{attrs:{storeNo:t.storeNo}})],1)])],1)],1),a("van-action-sheet",{staticClass:"show",attrs:{title:"购物车"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticClass:"content"},t._l(t.localFoods,(function(e,o){return a("div",{key:o,staticClass:"cart_item"},[a("div",{staticClass:"cart_title"},[t._v(t._s(e.foodName))]),a("div",{staticClass:"cart_right"},[a("div",{staticClass:"cart_price"},[t._v("￥"+t._s(e.totalprice))]),a("div",{staticClass:"cart_num"},[a("div",{staticClass:"stepper"},[a("div",{staticClass:"reduce",on:{click:function(e){return t.handleReduce1(o)}}},[t._v("-")]),a("div",{staticClass:"num"},[t._v(t._s(e.num))]),a("div",{staticClass:"add",on:{click:function(e){return t.handleAdd1(o)}}},[t._v("+")])])]),t.specification[o]?a("div",{staticClass:"bottom"},[t._v(" 规格："+t._s(t.specification[o])+" ")]):t._e()])])})),0)])],1)},s=[],i=a("2909"),n=a("5530"),r=a("1da1"),c=(a("96cf"),a("159b"),a("d3b7"),a("25f0"),a("ac1f"),a("466d"),a("b680"),a("a434"),a("d81d"),a("99af"),a("2b0e")),l=a("951d"),d=a.n(l),u=a("ad06"),m=a("543e"),f=a("0b33"),h=a("5e46"),p=a("20fb"),g=a("28a2"),v=a("ab2c"),_=a("2241"),I=a("4ec3"),C=a("9431"),S=a("9d6b"),A=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"comment"},[0==t.listData.length?o("div",{staticClass:"no_comment"},[o("van-empty",{attrs:{description:"暂无评论"}})],1):o("div",{staticClass:"content"},[o("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多评论了","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.listData,(function(e,s){return o("div",{key:s,staticClass:"comment_item"},[o("div",{staticClass:"userInfo"},[e.isAnonymous?o("img",{attrs:{src:a("76fc")}}):o("img",{attrs:{src:e.memberAvatar}}),o("div",[e.isAnonymous?o("div",{staticClass:"name"},[t._v("匿名用户")]):o("div",{staticClass:"name"},[t._v(t._s(e.memberName))]),o("div",{staticClass:"star"},[o("van-rate",{attrs:{readonly:""},model:{value:e.averageScore,callback:function(a){t.$set(e,"averageScore",a)},expression:"item.averageScore"}}),o("div",{staticClass:"time"},[t._v(t._s(e.createTime))])],1)])]),o("div",{staticClass:"comment_text"},[t._v(t._s(e.content))]),e.likeFoodNameList?o("div",{staticClass:"like"},[o("div",{staticClass:"menu"},t._l(e.likeFoodNameList,(function(e,a){return o("div",{key:a,staticClass:"item"},[o("van-icon",{attrs:{name:"good-job"}}),o("span",[t._v(t._s(e))])],1)})),0)]):t._e(),0!=e.images.length?o("div",{staticClass:"comment_img"},t._l(e.images,(function(a,s){return o("img",{directives:[{name:"lazy",rawName:"v-lazy",value:a,expression:"item1"}],key:s,class:1==e.images.length?"img1":"img",on:{click:function(a){return t.handleImg(e.images,s)}}})})),0):t._e(),e.storeAnswer?o("div",{staticClass:"shop_comment"},[o("div",{staticClass:"shop_comment_content"},[t._v("商家回复("+t._s(e.answerIntervalTime)+")："+t._s(e.storeAnswer))])]):t._e()])})),0)],1)])},N=[],b=a("f0ca"),k=a("343b"),w=a("39d1"),O=a("2bdd");c["a"].use(g["a"]),c["a"].use(b["a"]),c["a"].use(k["a"]),c["a"].use(w["a"]),c["a"].use(O["a"]);var F={props:["storeNo"],data:function(){return{listData:[],loading:!1,finished:!1,data:{pageNum:1,pageSize:10},star:2}},methods:{handleImg:function(t,e){var a=[];t.forEach((function(t){a.push(t)})),Object(g["a"])({images:[].concat(a),startPosition:e})},getShopComment:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(I["q"])(t.data);case 2:a=e.sent,200===a.status&&(t.loading=!1,a.data.data.length<10&&(t.finished=!0),t.listData=t.listData.concat(a.data.data));case 4:case"end":return e.stop()}}),e)})))()},onLoad:function(){this.data.pageNum=this.data.pageNum+1,this.getShopComment()}},created:function(){this.$set(this.data,"storeNo",this.storeNo),this.getShopComment()}},L=F,T=(a("30dc"),a("2877")),y=Object(T["a"])(L,A,N,!1,null,"19987806",null),E=y.exports;c["a"].use(u["a"]),c["a"].use(m["a"]),c["a"].use(f["a"]),c["a"].use(h["a"]),c["a"].use(p["a"]),c["a"].use(g["a"]),c["a"].use(v["a"]),c["a"].use(_["a"]);var P={components:{Food:S["a"],Comment:E},data:function(){return{storeNo:0,active:0,value:0,foods:[],shop:{},localFoods:[],show:!1,showShop:!1,total:0,allPrice:0,loading:!0,logo:d.a,shopImg:[],loadingPage:!0,type:"0",cartShow:!1,specification:[],isFromPoster:!1,storeAdvertise:[],storeAdvertiseTwo:[]}},methods:{settlementOrder:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,o,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a={},o=[],t.localFoods&&t.localFoods.forEach((function(t,e){var a={};a.foodId=t.foodId,a.number=t.num,t.sizeList&&(a.sizeList=t.sizeList),o.push(a)})),a.isPickBySelf=!1,a.foodItemList=o,a.storeNo=t.storeNo,a.useCoupon=!0,a.payWay="1",a.eatTime=JSON.parse(localStorage.getItem("eatTime"))?JSON.parse(localStorage.getItem("eatTime")):"",a.eatDate=JSON.parse(localStorage.getItem("eatDate"))||"",a.addressId=JSON.parse(localStorage.getItem("distributePoints")).addressId||"",e.next=14,Object(I["R"])(a);case 14:s=e.sent,200===s.status&&t.loadingTime({path:"/groupmeal/groupmealaccount?storeNo=".concat(t.storeNo)}),e.next=23;break;case 18:e.prev=18,e.t0=e["catch"](0),i=t,i.loadingPage=!1,e.t0.data&&_["a"].alert({message:e.t0.data.msg}).then((function(){}));case 23:case"end":return e.stop()}}),e,null,[[0,18]])})))()},fixFloatCalcRudely:function(t){if("number"===typeof t){var e=t.toString(),a=e.match(/\.(\d*?)(9|0)\2{5,}(\d{1,5})$/);if(null!=a)return t.toFixed(a[1].length)-0}return t},loadingTime:function(t){this.$router.push(t)},toShopList:function(){var t=0;this.loadingTime({path:"/groupmeal/groupmealshop/"+t})},onClickLeft:function(){var t=JSON.parse(localStorage.getItem("eatTime"));localStorage.setItem("groupmealPath",JSON.stringify("foods")),this.$router.push("/groupmeal/groupmealshop/"+t)},handleAdd:function(t,e,a){var o=this;this.total+=1;var s=JSON.parse(localStorage.getItem("cart"))?JSON.parse(localStorage.getItem("cart")):[];this.localFoods=s;var i=!1,r=0;if(s.length>0&&(s.forEach((function(n,c){n.foodId===o.foods[t].foodList[e].foodId&&(r=parseInt(r)+parseInt(n.num),a?a==n.sizeList&&(n.num=n.num+1,o.$set(s[c],"num",n.num),o.$set(s[c],"totalprice",parseInt(n.num*(1e3*n.price+1e3*n.packAmount))/1e3),o.allPrice=parseInt(1e3*o.allPrice+1e3*n.price+1e3*n.packAmount)/1e3,i=!0):a||n.sizeList||(n.num=n.num+1,o.$set(s[c],"num",n.num),o.$set(s[c],"totalprice",parseInt(n.num*(1e3*n.price+1e3*n.packAmount))/1e3),o.allPrice=parseInt(1e3*o.allPrice+1e3*n.price+1e3*n.packAmount)/1e3,i=!0))})),this.$set(this.foods[t].foodList[e],"num",++r),this.localFoods=s),0===this.localFoods.length||!i){var c=Object(n["a"])({},this.foods[t].foodList[e]),l=c.foodId,d=c.price,u=c.foodTypeId,m=c.foodName,f=c.packAmount,h={foodId:l,price:d,foodTypeId:u,foodName:m,packAmount:f,num:1};a?(h.sizeList=a,this.$set(this.foods[t].foodList[e],"num",parseInt(r))):this.$set(this.foods[t].foodList[e],"num",1),h.totalprice=h.price+h.packAmount,this.allPrice=this.fixFloatCalcRudely(parseInt(1e3*this.allPrice+1e3*this.foods[t].foodList[e].price+1e3*this.foods[t].foodList[e].packAmount))/1e3,this.localFoods.push(h)}localStorage.setItem("cart",JSON.stringify(this.localFoods))},handleAdd1:function(t){var e=this,a=Object(i["a"])(this.localFoods);this.foods.forEach((function(o,s){o.foodList.forEach((function(o,i){o.foodId===a[t].foodId&&e.handleAdd(s,i,a[t].sizeList)}))}))},handleReduce:function(t,e,a){var o=this;this.total-=1;var s=0,n=JSON.parse(localStorage.getItem("cart"));n.forEach((function(r,c){r.foodId===o.foods[t].foodList[e].foodId&&(s=parseInt(s)+parseInt(r.num),a?a==r.sizeList&&(r.num=r.num-1,o.$set(n[c],"num",r.num),o.$set(n[c],"totalprice",parseInt(r.num*(1e3*r.price+1e3*r.packAmount))/1e3),o.allPrice=parseInt(1e3*o.allPrice-1e3*r.price-1e3*r.packAmount)/1e3,o.localFoods=Object(i["a"])(n),0===o.localFoods[c].num?(o.localFoods.splice(c,1),0===o.localFoods.length?(localStorage.removeItem("cart"),o.show=!1):localStorage.setItem("cart",JSON.stringify(o.localFoods))):localStorage.setItem("cart",JSON.stringify(o.localFoods))):a||r.sizeList||(r.num=r.num-1,o.$set(n[c],"num",r.num),o.$set(n[c],"totalprice",parseInt(r.num*(1e3*r.price+1e3*r.packAmount))/1e3),o.allPrice=parseInt(1e3*o.allPrice-1e3*r.price-1e3*r.packAmount)/1e3,o.localFoods=Object(i["a"])(n),0===o.localFoods[c].num?(o.localFoods.splice(c,1),0===o.localFoods.length?(localStorage.removeItem("cart"),o.show=!1):localStorage.setItem("cart",JSON.stringify(o.localFoods))):localStorage.setItem("cart",JSON.stringify(o.localFoods))))})),this.$set(this.foods[t].foodList[e],"num",--s),this.specification=this.localFoods.map((function(t){var e="";if(t.sizeList){var a=t.sizeList;return a.forEach((function(t){e=e+t.tagValue.sizeName+" "})),e}return e}))},handleReduce1:function(t){var e=this,a=Object(i["a"])(this.localFoods);this.foods.forEach((function(o,s){o.foodList.forEach((function(o,i){o.foodId===a[t].foodId&&e.handleReduce(s,i,a[t].sizeList)}))}))},handleActivity:function(t){var e=this,a=[];this.shopImg.forEach((function(t){a.push("".concat(e.$imgUrl).concat(t))})),Object(g["a"])({images:a,startPosition:t})},handleCart:function(){0===this.localFoods.length?this.show=!1:(this.specification=this.localFoods.map((function(t){var e="";if(t.sizeList){var a=t.sizeList;return a.forEach((function(t){e=e+t.tagValue.sizeName+" "})),e}return e})),this.show=!0)},handleAccount:function(){this.total>0?this.settlementOrder():_["a"].alert({message:"您还没添加购买的商品哦！"}).then((function(){}))},foodNemuList:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,o,s,i,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a="",o=[],s={},s.addressId=JSON.parse(localStorage.getItem("distributePoints")).addressId,s.eatTime=JSON.parse(localStorage.getItem("eatTime"))?JSON.parse(localStorage.getItem("eatTime")):"",s.eatDate=JSON.parse(localStorage.getItem("eatDate")),s.storeNo=t.storeNo,e.next=9,Object(C["b"])(s);case 9:i=e.sent,t.foods=i.data.data,n=JSON.parse(localStorage.getItem("cart"))?JSON.parse(localStorage.getItem("cart")):[],n.length<=0&&(n=JSON.parse(localStorage.getItem("orderDetailCart"))?JSON.parse(localStorage.getItem("orderDetailCart")):[]),t.localFoods=n,t.foods.forEach((function(e,a){e.foodList.forEach((function(e,o){t.$set(t.foods[a].foodList[o],"num",0)}))})),t.localFoods.length>0&&(t.foods.forEach((function(e,a){e.foodList.forEach((function(e,s){t.localFoods.forEach((function(i,n){i.foodId===e.foodId&&(t.$set(t.foods[a].foodList[s],"num",i.num),t.total=t.total+i.num,t.allPrice=parseInt(1e3*t.allPrice+1e3*(e.price+e.packAmount)*i.num)/1e3,t.$set(t.localFoods[n],"totalprice",parseInt(1e3*(e.price+e.packAmount)*i.num)/1e3),t.$set(t.localFoods[n],"price",e.price),o.push(i.foodId))}))}))})),localStorage.setItem("cart",JSON.stringify(t.localFoods)),localStorage.removeItem("orderDetailCart"),t.localFoods.length!==o.length&&(r=!1,t.localFoods.forEach((function(t){r=!1,o.forEach((function(e){e.foodId===t.foodId&&(r=!0)})),r||(a="“"+a+t.foodName+"” ")})))),setTimeout((function(){if(t.loading=!1,t.loadingPage=!1,""===a)return!1;_["a"].alert({message:"当前的"+a+"已经下架或者已经售罄了哦"}).then((function(){}))}),0);case 17:case"end":return e.stop()}}),e)})))()},shopInfo:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(I["S"])({storeNo:t.storeNo});case 2:a=e.sent,t.shop=a.data.data,t.shopImg=Object(i["a"])(JSON.parse(t.shop.storeEnvironmentImg)),t.storeAdvertise=Object(i["a"])(JSON.parse(a.data.data.storeAdvertise)),t.storeAdvertiseTwo=Object(i["a"])(JSON.parse(a.data.data.storeAdvertiseTwo));case 7:case"end":return e.stop()}}),e)})))()},handleClick:function(t){this.showShop=1===t}},created:function(){var t=this;this.storeNo=localStorage.getItem("storeNo"),this.shopInfo(),localStorage.removeItem("orderNo"),setTimeout((function(){t.foodNemuList()}),100)}},x=P,J=(a("6389"),Object(T["a"])(x,o,s,!1,null,"56e9d637",null));e["default"]=J.exports},"76fc":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAfBAMAAADtgAsKAAAAG1BMVEXY2Nj////39/ft7e37+/vg4ODx8fH09PTn5+d6KYZvAAAAdklEQVQoz53PQQ5FMBCA4b5FH0s/EtuGC3ADTbBGXMBNuDkWjUk0lfiXX5uZjPpc1A1h+FkwElYgqwXYE1ITAq6SN8jbB4TWTif0o4D/CrUKgZ5AyeIdNgnNvcULeuYqH+U79x+94Cr8sFhwGXcYckopqjzw3gGvCBa4m3IHvQAAAABJRU5ErkJggg=="},9431:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"g",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"d",(function(){return c})),a.d(e,"f",(function(){return l})),a.d(e,"e",(function(){return d})),a.d(e,"c",(function(){return u}));var o=a("b775"),s=o["b"];function i(t){return s({url:"/api/wx/orderMeal/menuByCategory",method:"GET",params:t})}function n(t){return s({url:"/api/wx/orderMeal/supplyTimeTable",method:"GET",params:t})}function r(){return s({url:"/api/wx/orderMeal/distributePoints",method:"GET"})}function c(){return s({url:"/api/wx/orderMeal/pointsToStoreList",method:"GET"})}function l(){return s({url:"/api/wx/orderMeal/queryQualification",method:"GET"})}function d(t){return s({url:"/api/wx/order/queryGroupOrderProgress",method:"GET",params:t})}function u(t){return s({url:"/api/wx/orderMeal/bindCompany",method:"POST",data:t})}},"98e6":function(t,e,a){},"9b25":function(t,e,a){}}]);